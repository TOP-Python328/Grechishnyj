-- 1. Вывести средний оклад (salary) всех сотрудников
select avg(salary) from doctors;
-- +--------------+
-- | avg(salary)  |
-- +--------------+
-- | 72767.671429 |
-- +--------------+
-- 1 row in set (0.0011 sec)


-- 2. Вывести среднюю премию для всех сотрудников, чей доход выше среднего (взять явное значение из результата предыдущего запроса)
select avg(premium) from doctors where salary > 72767.671429;
-- +--------------+
-- | avg(premium) |
-- +--------------+
-- | 21681.382353 |
-- +--------------+
-- 1 row in set (0.0012 sec)


-- 3. Вывести с сортировкой по возрастанию среднее количество дней в отпуске для каждого сотрудника — используйте функцию datediff()
select doctors_id, avg(datediff(end_date, start_date)) as days from vacations 
group by doctors_id 
order by days;
-- +------------+---------+
-- | doctors_id | days    |
-- +------------+---------+
-- |         64 | 16.4545 |
-- |          4 | 18.4444 |
-- |         19 | 18.5714 |
-- |         40 | 18.7333 |
-- |         28 | 19.2222 |
-- |         52 | 19.5882 |
-- |         39 | 19.7500 |
-- |         45 | 19.8095 |
-- |         18 | 20.1818 |
-- |         42 | 20.4000 |
-- |         12 | 20.6471 |
-- |         29 | 20.8400 |
-- |         37 | 20.8889 |
-- |          3 | 21.0000 |
-- |         56 | 21.0000 |
-- |          5 | 21.1875 |
-- |         57 | 21.2500 |
-- |         68 | 21.3333 |
-- |         59 | 21.3571 |
-- |         70 | 21.5000 |
-- |         34 | 21.5000 |
-- |         20 | 21.5455 |
-- |         26 | 21.6000 |
-- |         49 | 22.0000 |
-- |         35 | 22.2222 |
-- |          8 | 22.3571 |
-- |         23 | 22.4545 |
-- |         67 | 22.5000 |
-- |         27 | 22.6667 |
-- |         66 | 22.8462 |
-- |         50 | 22.8750 |
-- |         43 | 22.9167 |
-- |         62 | 23.0000 |
-- |          7 | 23.0000 |
-- |         25 | 23.0588 |
-- |         22 | 23.5217 |
-- |          2 | 23.6000 |
-- |          9 | 23.6429 |
-- |         44 | 24.0000 |
-- |         47 | 24.2667 |
-- |         41 | 24.3571 |
-- |         63 | 24.3636 |
-- |         15 | 25.0952 |
-- |         33 | 25.2000 |
-- |         46 | 25.2778 |
-- |         48 | 25.3333 |
-- |         58 | 25.5294 |
-- |         32 | 25.5556 |
-- |         54 | 25.6316 |
-- |         16 | 25.7500 |
-- |         61 | 25.7692 |
-- |         14 | 25.8235 |
-- |         60 | 25.8889 |
-- |         38 | 26.0000 |
-- |         53 | 26.1667 |
-- |         13 | 26.4000 |
-- |         10 | 26.6154 |
-- |         36 | 26.8235 |
-- |         17 | 27.0000 |
-- |          6 | 27.2941 |
-- |         65 | 27.5882 |
-- |         51 | 27.9231 |
-- |         30 | 28.0000 |
-- |         11 | 28.5000 |
-- |         31 | 28.5455 |
-- |         55 | 28.6667 |
-- |         69 | 28.8235 |
-- |         21 | 29.0000 |
-- |          1 | 29.0000 |
-- |         24 | 29.1818 |
-- +------------+---------+
-- 70 rows in set (0.0027 sec)


-- 4. Вывести для каждого сотрудника самый ранний год отпуска и самый поздний год отпуска с сортировкой по возрастанию разности между этими двумя значениями
 select doctors_id, max(year(end_date)) - min(year(start_date)) as difference 
 from vacations 
 group by doctors_id 
 order by difference;
-- +------------+------------+
-- | doctors_id | difference |
-- +------------+------------+
-- |         34 |          6 |
-- |         57 |          9 |
-- |         27 |         12 |
-- |         70 |         12 |
-- |         49 |         12 |
-- |          9 |         13 |
-- |         38 |         13 |
-- |         62 |         14 |
-- |         12 |         14 |
-- |         33 |         14 |
-- |         67 |         14 |
-- |          7 |         15 |
-- |         37 |         15 |
-- |         18 |         15 |
-- |         60 |         15 |
-- |         43 |         15 |
-- |          3 |         16 |
-- |          4 |         16 |
-- |          5 |         16 |
-- |         36 |         16 |
-- |         39 |         16 |
-- |         11 |         16 |
-- |         15 |         16 |
-- |         52 |         16 |
-- |         48 |         16 |
-- |         40 |         16 |
-- |         31 |         17 |
-- |         32 |         17 |
-- |          8 |         17 |
-- |         17 |         17 |
-- |         42 |         17 |
-- |         54 |         17 |
-- |         16 |         17 |
-- |          2 |         18 |
-- |         23 |         18 |
-- |         10 |         18 |
-- |         21 |         18 |
-- |         14 |         18 |
-- |         45 |         18 |
-- |         55 |         18 |
-- |         47 |         18 |
-- |         53 |         18 |
-- |         61 |         19 |
-- |         44 |         19 |
-- |         64 |         19 |
-- |         26 |         19 |
-- |         65 |         19 |
-- |          1 |         19 |
-- |         25 |         19 |
-- |         69 |         19 |
-- |         24 |         19 |
-- |         22 |         19 |
-- |         20 |         19 |
-- |         13 |         20 |
-- |         41 |         20 |
-- |         28 |         20 |
-- |         19 |         20 |
-- |         50 |         20 |
-- |         56 |         20 |
-- |         30 |         20 |
-- |         29 |         21 |
-- |         35 |         21 |
-- |         46 |         21 |
-- |         63 |         21 |
-- |         51 |         21 |
-- |         66 |         21 |
-- |         68 |         21 |
-- |         59 |         21 |
-- |          6 |         23 |
-- |         58 |         24 |
-- +------------+------------+
-- 70 rows in set (0.0017 sec)


-- 5. Вывести сумму пожертвований за всё время для каждого отделения с сортировкой по возрастанию номеров отделений
select departments_id as num, sum(amount)
from donations 
group by num 
order by num;
-- +-----+-------------+
-- | num | donat       |
-- +-----+-------------+
-- |   1 |  3906387.00 |
-- |   2 | 14824812.00 |
-- |   3 |  5329716.00 |
-- |   4 | 17541590.00 |
-- |   5 | 18834643.00 |
-- |   6 |  8932248.00 |
-- |   7 |  3288830.00 |
-- +-----+-------------+
-- 7 rows in set (0.0007 sec)


select sponsors_id, year(date) as dt, sum(amount) 
from donations 
group by sponsors_id, dt 
order by sponsors_id, dt;
-- +-------------+------+-------------+
-- | sponsors_id | dt   | sum(amount) |
-- +-------------+------+-------------+
-- |           1 | 2008 |  2031320.00 |
-- |           2 | 2004 |   245080.00 |
-- |           2 | 2005 |  1629290.00 |
-- |           2 | 2007 |  1580363.00 |
-- |           2 | 2009 |  2531422.00 |
-- |           2 | 2016 |  1843308.00 |
-- |           2 | 2018 |   947229.00 |
-- |           2 | 2022 |  1856049.00 |
-- |           3 | 2003 |   803356.00 |
-- |           3 | 2007 |   685092.00 |
-- |           3 | 2018 |   388077.00 |
-- |           3 | 2023 |  1938799.00 |
-- |           4 | 2011 |   361385.00 |
-- |           4 | 2012 |  2941727.00 |
-- |           4 | 2013 |   930587.00 |
-- |           4 | 2019 |  1068710.00 |
-- |           4 | 2020 |   663411.00 |
-- |           5 | 2004 |   685164.00 |
-- |           5 | 2017 |  1895232.00 |
-- |           5 | 2021 |  1069726.00 |
-- |           6 | 2001 |   780396.00 |
-- |           6 | 2014 |  1452917.00 |
-- |           6 | 2022 |  1975012.00 |
-- |           7 | 2000 |  1862822.00 |
-- |           7 | 2011 |   735002.00 |
-- |           7 | 2014 |  1178937.00 |
-- |           7 | 2015 |  1609155.00 |
-- |           7 | 2020 |  1466515.00 |
-- |           8 | 2001 |  1111250.00 |
-- |           8 | 2003 |  1588752.00 |
-- |           8 | 2005 |  1164363.00 |
-- |           8 | 2006 |   837864.00 |
-- |           8 | 2007 |  2095266.00 |
-- |           8 | 2009 |  1749319.00 |
-- |           8 | 2013 |  1672141.00 |
-- |           8 | 2017 |   749144.00 |
-- |           8 | 2023 |   322365.00 |
-- |           9 | 2004 |  2373314.00 |
-- |           9 | 2007 |   977319.00 |
-- |           9 | 2012 |  1754645.00 |
-- |           9 | 2014 |   406599.00 |
-- |           9 | 2018 |   962637.00 |
-- |           9 | 2019 |  1458650.00 |
-- |           9 | 2023 |   913410.00 |
-- |          10 | 2003 |  1978306.00 |
-- |          10 | 2006 |   957355.00 |
-- |          10 | 2012 |   602358.00 |
-- |          10 | 2014 |  1450246.00 |
-- |          10 | 2017 |   749196.00 |
-- |          10 | 2019 |    85473.00 |
-- |          10 | 2020 |   233839.00 |
-- |          10 | 2023 |  1078535.00 |
-- |          11 | 2006 |   669379.00 |
-- |          11 | 2012 |  1353578.00 |
-- |          11 | 2014 |   359862.00 |
-- |          11 | 2019 |   480300.00 |
-- |          11 | 2021 |   582378.00 |
-- |          12 | 2002 |   772941.00 |
-- |          12 | 2006 |   277402.00 |
-- |          12 | 2012 |  1736411.00 |
-- |          12 | 2018 |   127413.00 |
-- |          12 | 2021 |  1870133.00 |
-- +-------------+------+-------------+
-- 62 rows in set (0.0007 sec)